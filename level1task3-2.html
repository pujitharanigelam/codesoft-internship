<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>E-Commerce Demo</title>
  <style>
    :root { --primary:#16a34a; --bg:#0f172a; --card:#111827; --text:#e5e7eb; --muted:#9ca3af; }
    body { margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial; background:var(--bg); color:var(--text); }
    header { display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid #1f2937; position:sticky; top:0; background:var(--bg); z-index:10; }
    .container { max-width:1100px; margin:0 auto; padding:16px; }
    .grid { display:grid; grid-template-columns:240px 1fr; gap:16px; }
    .list { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:12px; }
    .card { background:var(--card); border:1px solid #1f2937; border-radius:10px; padding:12px; }
    .btn { background:var(--primary); color:white; border:none; border-radius:8px; padding:10px 14px; cursor:pointer; }
    .btn.secondary { background:#374151; }
    input, select { width:100%; padding:10px; border-radius:8px; border:1px solid #374151; background:#0b1220; color:var(--text); }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    img { width:100%; height:160px; object-fit:cover; border-radius:8px; background:#0b1220; }
    .price { color:#86efac; font-weight:600; }
    .muted { color:#94a3b8; font-size:12px; }
    @media (max-width:820px){ .grid { display:block; } }
  </style>
</head>
<body>
  <header>
    <strong>Shop Demo</strong>
    <div class="row" style="align-items:center;">
      <button class="btn secondary" onclick="route('catalog')">Catalog</button>
      <button class="btn secondary" onclick="route('cart')">Cart (<span id="cartCount">0</span>)</button>
      <button class="btn" onclick="route('checkout')">Checkout</button>
    </div>
  </header>

  <main class="container">
    <!-- Catalog -->
    <section id="catalog" class="grid">
      <aside class="card">
        <h4>Filters</h4>
        <label>Search</label>
        <input id="fSearch" placeholder="Find products…" oninput="renderProducts()" />
        <label style="margin-top:8px;">Category</label>
        <select id="fCat" onchange="renderProducts()">
          <option value="">All</option>
          <option>Electronics</option>
          <option>Books</option>
          <option>Clothing</option>
        </select>
        <div class="row" style="margin-top:8px;">
          <div>
            <label>Min price</label>
            <input id="fMin" type="number" min="0" oninput="renderProducts()" />
          </div>
          <div>
            <label>Max price</label>
            <input id="fMax" type="number" min="0" oninput="renderProducts()" />
          </div>
        </div>
        <label style="margin-top:8px;">Sort by</label>
        <select id="fSort" onchange="renderProducts()">
          <option value="new">Newest</option>
          <option value="price_asc">Price: Low to High</option>
          <option value="price_desc">Price: High to Low</option>
        </select>
        <button class="btn secondary" style="margin-top:8px;" onclick="resetFilters()">Reset</button>
      </aside>
      <section>
        <div class="row" style="align-items:center; justify-content:space-between;">
          <h3 style="margin:0;">Products</h3>
          <span class="muted">Demo-only; no real payment</span>
        </div>
        <div id="productList" class="list" style="margin-top:12px;"></div>
      </section>
    </section>

    <!-- Cart -->
    <section id="cart" class="card hidden">
      <h3>Your cart</h3>
      <div id="cartItems"></div>
      <div class="row" style="margin-top:12px; align-items:center;">
        <strong>Total: <span id="cartTotal" class="price">₹0</span></strong>
        <button class="btn" onclick="route('checkout')">Proceed to checkout</button>
        <button class="btn secondary" onclick="clearCart()">Clear</button>
      </div>
    </section>

    <!-- Checkout -->
    <section id="checkout" class="card hidden">
      <h3>Checkout</h3>
      <div class="row">
        <div>
          <label>Name</label><input id="cName" />
        </div>
        <div>
          <label>Phone</label><input id="cPhone" />
        </div>
      </div>
      <div class="row" style="margin-top:8px;">
        <div><label>Address line 1</label><input id="cL1" /></div>
        <div><label>Address line 2</label><input id="cL2" /></div>
      </div>
      <div class="row" style="margin-top:8px;">
        <div><label>City</label><input id="cCity" /></div>
        <div><label>State</label><input id="cState" /></div>
        <div><label>Postal code</label><input id="cZip" /></div>
      </div>
      <div class="row" style="margin-top:8px;">
        <button class="btn" onclick="placeOrder()">Place order (test)</button>
        <button class="btn secondary" onclick="route('catalog')">Back to catalog</button>
      </div>
      <p class="muted" id="orderStatus" style="margin-top:8px;"></p>
    </section>
  </main>

  <script>
    // Router
    function route(id) {
      for (const el of document.querySelectorAll('main > section')) el.classList.add('hidden');
      document.getElementById(id).classList.remove('hidden');
      if (id === 'catalog') renderProducts();
      if (id === 'cart') renderCart();
    }

    // Demo products
    const PRODUCTS = [
      { id:'p1', title:'Wireless Headphones', price:2999, category:'Electronics', img:'https://picsum.photos/seed/p1/400/300' },
      { id:'p2', title:'JavaScript Book', price:699, category:'Books', img:'https://picsum.photos/seed/p2/400/300' },
      { id:'p3', title:'Cotton T-Shirt', price:499, category:'Clothing', img:'https://picsum.photos/seed/p3/400/300' },
      { id:'p4', title:'Smart Watch', price:4999, category:'Electronics', img:'https://picsum.photos/seed/p4/400/300' },
      { id:'p5', title:'Denim Jeans', price:1499, category:'Clothing', img:'https://picsum.photos/seed/p5/400/300' },
      { id:'p6', title:'Data Structures Guide', price:899, category:'Books', img:'https://picsum.photos/seed/p6/400/300' }
    ];

    // Cart
    const CART_KEY = 'shop_cart_v1';
    function getCart(){ return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); }
    function setCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); updateCount(); }
    function addToCart(id){
      const cart = getCart();
      const item = cart.find(i => i.id === id);
      if (item) item.qty += 1; else cart.push({ id, qty:1 });
      setCart(cart);
    }
    function removeFromCart(id){
      setCart(getCart().filter(i => i.id !== id));
    }
    function updateQty(id, qty){
      const cart = getCart();
      const it = cart.find(i => i.id === id);
      if (!it) return;
      it.qty = Math.max(1, qty);
      setCart(cart);
      renderCart();
    }
    function clearCart(){ setCart([]); renderCart(); }
    function updateCount(){
      const count = getCart().reduce((a,i)=>a+i.qty,0);
      document.getElementById('cartCount').textContent = count;
    }

    // Render products with filters
    function resetFilters(){
      document.getElementById('fSearch').value='';
      document.getElementById('fCat').value='';
      document.getElementById('fMin').value='';
      document.getElementById('fMax').value='';
      document.getElementById('fSort').value='new';
      renderProducts();
    }
    function renderProducts(){
      const term = (document.getElementById('fSearch').value||'').toLowerCase();
      const cat = document.getElementById('fCat').value;
      const min = +document.getElementById('fMin').value || 0;
      const max = +document.getElementById('fMax').value || Infinity;
      const sort = document.getElementById('fSort').value;

      let list = PRODUCTS.filter(p =>
        p.title.toLowerCase().includes(term) &&
        (!cat || p.category === cat) &&
        p.price >= min && p.price <= max
      );
      if (sort==='price_asc') list.sort((a,b)=>a.price-b.price);
      else if (sort==='price_desc') list.sort((a,b)=>b.price-a.price);
      else list = list; // newest: keep original

      const wrap = document.getElementById('productList');
      wrap.innerHTML = '';
      list.forEach(p=>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img alt="${p.title}" src="${p.img}" />
          <h4 style="margin:8px 0 0;">${p.title}</h4>
          <div class="row" style="align-items:center; justify-content:space-between; margin-top:6px;">
            <span class="price">₹${p.price}</span>
            <span class="muted">${p.category}</span>
          </div>
          <div class="row" style="margin-top:8px;">
            <button class="btn" onclick="addToCart('${p.id}')">Add to cart</button>
            <button class="btn secondary" onclick="viewProduct('${p.id}')">View</button>
          </div>
        `;
        wrap.appendChild(card);
      });
      if (!list.length) wrap.innerHTML = '<p>No products match your filters.</p>';
      updateCount();
    }
    function viewProduct(id){
      const p = PRODUCTS.find(x=>x.id===id);
      alert(`${p.title}\nCategory: ${p.category}\nPrice: ₹${p.price}`);
    }

    // Render cart
    function renderCart(){
      const cart = getCart();
      const itemsWrap = document.getElementById('cartItems');
      itemsWrap.innerHTML = '';
      let total = 0;
      cart.forEach(ci=>{
        const p = PRODUCTS.find(x=>x.id===ci.id);
        total += (p.price * ci.qty);
        const row = document.createElement('div');
        row.className = 'card';
        row.innerHTML = `
          <div class="row" style="align-items:center;">
            <img alt="${p.title}" src="${p.img}" style="width:120px; height:90px;" />
            <div style="flex:1;">
              <strong>${p.title}</strong>
              <div class="muted">${p.category}</div>
              <div class="price">₹${p.price}</div>
            </div>
            <div>
              <label>Qty</label>
              <input type="number" min="1" value="${ci.qty}" onchange="updateQty('${ci.id}', +this.value)" />
            </div>
            <button class="btn secondary" onclick="removeFromCart('${ci.id}')">Remove</button>
          </div>
        `;
        itemsWrap.appendChild(row);
      });
      document.getElementById('cartTotal').textContent = `₹${total}`;
      if (!cart.length) itemsWrap.innerHTML = '<p>Your cart is empty.</p>';
      updateCount();
    }

    // Checkout (demo)
    function placeOrder(){
      const cart = getCart();
      if (!cart.length) return alert('Your cart is empty.');
      const fields = ['cName','cPhone','cL1','cCity','cState','cZip'];
      if (fields.some(id=>!document.getElementById(id).value)) return alert('Please fill all required fields.');
      document.getElementById('orderStatus').textContent = 'Order placed (demo). Payment integration comes next.';
      clearCart();
      route('catalog');
    }

    // Init
    route('catalog');
  </script>
</body>
</html>
